<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <template id="general_ledger_hierarchy_pdf_table">
        <t t-foreach="ks_report_lines" t-as="account_line" t-key="account_line_index">
            <t t-if="'lines' in account_line">
                <t t-foreach="account_line['lines']" t-as="sub_line">
                    <t t-if="sub_line['initial_bal']">
                        <tr style="page-break-inside: avoid;" class="pims_report_line_initial_tr">
                            <td colspan="5" class="text-right">
                                <span>Initial Balance</span>
                            </td>
                            <td class="text-right">
                                <t t-if="sub_line['balance']">
                                    <span t-esc="sub_line['balance']"
                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                </t>
                                <t t-else="">
                                    <span t-att-style="style">-</span>
                                </t>
                            </td>
                            <td class="text-right">
                                <t t-if="jsub_line['credit']">
                                    <span t-esc="sub_line['credit']"
                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                </t>
                                <t t-else="">
                                    <span t-att-style="style">-</span>
                                </t>
                            </td>
                            <td class="text-right">
                                <t t-if="sub_line['balance']">
                                    <span t-esc="sub_line['balance']"
                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                </t>
                                <t t-else="">
                                    <span t-att-style="style">-</span>
                                </t>
                            </td>
                        </tr>
                    </t>

                    <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                        <t t-if="not sub_line['initial_bal'] and not sub_line['ending_bal']">
                            <tr style="page-break-inside: avoid;" class="pims_report_line_data_tr">
                                <td>
                                    <t t-esc="sub_line.get('ldate')"
                                       t-options='{"widget": "date"}'/>
                                </td>
                                <td>
                                    <t t-esc="sub_line.get('lcode')"/>
                                </td>
                                <td>
                                    <t t-esc="sub_line.get('partner_name')"/>
                                </td>
                                <td>
                                    <t t-esc="sub_line.get('move_name')"/>
                                </td>
                                <td style="width:30%;">
                                    <t t-esc="sub_line.get('lname')"/>
                                </td>
                                <td class="text-right">
                                    <t t-if="sub_line.get('debit')">
                                        <span t-esc="sub_line.get('debit')"
                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                    </t>
                                    <t t-else="">
                                        <span t-att-style="style">-</span>
                                    </t>
                                </td>
                                <td class="text-right">
                                    <t t-if="sub_line.get('credit')">
                                        <span t-esc="sub_line.get('credit')"
                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                    </t>
                                    <t t-else="">
                                        <span t-att-style="style">-</span>
                                    </t>
                                </td>
                                <td class="text-right">
                                    <t t-if="sub_line.get('balance')">
                                        <span t-esc="sub_line.get('balance')"
                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                    </t>
                                    <t t-else="">
                                        <span t-att-style="style">-</span>
                                    </t>
                                </td>
                            </tr>
                        </t>
                    </t>
                </t>
            </t>
            <t t-else="">
                <tr style="page-break-inside: avoid;" class="pims_report_line_main_tr">
                    <td colspan="5">
                        <span style="color: white;" t-esc="'..'"/>
                        <span t-esc="account_line['code']"/> _ <span t-esc="account_line['name']"/>
                    </td>
                    <td class="text-right">
                        <t t-if="account_line['debit']">
                            <span t-esc="account_line['debit']"
                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                        </t>
                        <t t-else="">
                            <span t-att-style="style">-</span>
                        </t>
                    </td>
                    <td class="text-right">
                        <t t-if="account_line['credit']">
                            <span t-esc="account_line['credit']"
                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                        </t>
                        <t t-else="">
                            <span t-att-style="style">-</span>
                        </t>
                    </td>
                    <td class="text-right">
                        <t t-if="account_line['balance']">
                            <span t-esc="account_line['balance']"
                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                        </t>
                        <t t-else="">
                            <span t-att-style="style">-</span>
                        </t>
                    </td>
                </tr>
            </t>

            <t t-if="'children' in account_line">
                <t t-set="ks_report_lines" t-value="account_line['children']"/>
                <t t-call="ks_dynamic_financial_report_customization.general_ledger_hierarchy_pdf_table"/>
            </t>
        </t>
    </template>

    <template id="general_ledger_hierarchy_pdf_with_initial_balance">
        <t t-foreach="ks_report_lines" t-as="account_line" t-key="account_line_index">
            <t t-if="'lines' in account_line">
                <t t-foreach="account_line['lines']" t-as="sub_line">
                    <t t-if="sub_line['initial_bal']">
                        <tr style="page-break-inside: avoid;"
                            class="pims_report_line_initial_tr">
                            <td colspan="5" class="text-right">
                                <span>Initial Balance</span>
                            </td>
                            <td class="text-right">
                                <t t-if="sub_line['balance']">
                                    <span t-esc="sub_line['balance']"
                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                </t>
                                <t t-else="">
                                    <span t-att-style="style">-</span>
                                </t>
                            </td>
                            <td class="text-right">
                                <t t-if="sub_line['credit']">
                                    <span t-esc="sub_line['credit']"
                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                </t>
                                <t t-else="">
                                    <span t-att-style="style">-</span>
                                </t>
                            </td>
                            <td class="text-right">
                                <t t-if="sub_line['balance']">
                                    <span t-esc="sub_line['balance']"
                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                </t>
                                <t t-else="">
                                    <span t-att-style="style">-</span>
                                </t>
                            </td>
                        </tr>
                    </t>
                    <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                        <t t-if="not sub_line['initial_bal'] and not sub_line['ending_bal']">
                            <tr style="page-break-inside: avoid;"
                                class="pims_report_line_data_tr">
                                <td>
                                    <t t-esc="sub_line.get('ldate')"
                                       t-options='{"widget": "date"}'/>
                                </td>
                                <td>
                                    <t t-esc="sub_line.get('lcode')"/>
                                </td>
                                <td>
                                    <t t-esc="sub_line.get('partner_name')"/>
                                </td>
                                <td>
                                    <t t-esc="sub_line.get('move_name')"/>
                                </td>
                                <td style="width:30%;">
                                    <t t-esc="sub_line.get('lname')"/>
                                </td>
                                <td class="text-right">
                                    <t t-if="sub_line.get('initial_balance')">
                                        <span t-esc="sub_line.get('initial_balance')"
                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                    </t>
                                    <t t-else="">
                                        <span t-att-style="style">-</span>
                                    </t>
                                </td>
                                <td class="text-right">
                                    <t t-if="sub_line.get('debit')">
                                        <span t-esc="sub_line.get('debit')"
                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                    </t>
                                    <t t-else="">
                                        <span t-att-style="style">-</span>
                                    </t>
                                </td>
                                <td class="text-right">
                                    <t t-if="sub_line.get('credit')">
                                        <span t-esc="sub_line.get('credit')"
                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                    </t>
                                    <t t-else="">
                                        <span t-att-style="style">-</span>
                                    </t>
                                </td>
                                <t t-set="initial_balance" t-value="0"></t>
                                <t t-if="'initial_balance' in sub_line">
                                    <t t-set="initial_balance"
                                       t-value="sub_line['initial_balance']"></t>
                                </t>
                                <td class="text-right">
                                    <t t-if="sub_line.get('balance')">
                                        <span t-esc="sub_line.get('balance') + initial_balance"
                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                    </t>
                                    <t t-else="">
                                        <span t-att-style="style">-</span>
                                    </t>
                                </td>
                            </tr>
                        </t>
                    </t>
                </t>
            </t>
            <t t-else="">
                <tr style="page-break-inside: avoid;" class="pims_report_line_main_tr">
                    <td colspan="5">
                        <span style="color: white;" t-esc="'..'"/>
                        <span t-esc="account_line['code']"/>
                        _
                        <span t-esc="account_line['name']"/>
                    </td>
                    <td class="text-right">
                        <t t-if="account_line['initial_balance']">
                            <span t-esc="account_line['initial_balance']"
                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                        </t>
                        <t t-else="">
                            <span t-att-style="style">-</span>
                        </t>
                    </td>

                    <td class="text-right">
                        <t t-if="account_line['debit']">
                            <span t-esc="account_line['debit']"
                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                        </t>
                        <t t-else="">
                            <span t-att-style="style">-</span>
                        </t>
                    </td>

                    <td class="text-right">
                        <t t-if="account_line['credit']">
                            <span t-esc="account_line['credit']"
                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                        </t>
                        <t t-else="">
                            <span t-att-style="style">-</span>
                        </t>
                    </td>
                    <td class="text-right">
                        <t t-if="account_line['balance']">
                            <span t-esc="account_line['balance']"
                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                        </t>
                        <t t-else="">
                            <span t-att-style="style">-</span>
                        </t>
                    </td>
                </tr>

            </t>

            <t t-if="'children' in account_line">
                <t t-set="ks_report_lines" t-value="account_line['children']"/>
                <t t-call="ks_dynamic_financial_report_customization.general_ledger_hierarchy_pdf_with_initial_balance"/>
            </t>
        </t>
    </template>



    <template id="ks_dynamic_financial_report.ks_dynamic_financial_general_ledger">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <t t-set="company"
                   t-value="request.env['res.company'].sudo().browse(js_data['ks_df_informations'].get('company_id'))"/>
                <div class="page">
                    <div class="oe_structure"/>
                    <div class="conatiner-fluid">
                        <div class="row">
                            <h3 class="py-3 col-12" style="font-size:25px;">
                                <span t-esc="company.name"/>: General ledger
                            </h3>
                        </div>

                        <div class="row my-2 pims_report_content">

                            <div class="col-3">
                                <strong>Display Account</strong>
                                <t t-if="js_data['ks_df_informations']['ks_posted_entries']">-
                                    <p>Posted Entries</p>
                                </t>
                            </div>
                            <t t-if="js_data['ks_df_informations']['date']['ks_process'] == 'range'">
                                <div class="col-3">
                                    <strong>Date From:</strong>
                                    <p t-esc="js_data['ks_df_informations']['date']['ks_start_date']"
                                    />
                                </div>
                                <div class="col-3">
                                    <strong>Date To:</strong>
                                    <p t-esc="js_data['ks_df_informations']['date']['ks_end_date']"
                                    />
                                </div>
                            </t>
                            <t t-else="">
                                <div class="col-3">
                                    <strong>As of Date:</strong>
                                    <p t-esc="js_data['ks_df_informations']['date']['ks_end_date']"
                                    />
                                .. 6 _ Expenditure $ 571.10 $ 571.10 -</div>

                            </t>

                        </div>

                        <div class="row my-2 pims_report_content">

                            <div class="col-3">
                                <strong>Accounts:</strong>
                                <p t-esc="', '.join(account.get('name') or '' for account in js_data['ks_df_informations']['account'] if account.get('selected'))"/>
                            </div>
                            <div class="col-3">
                                <strong>Journals:</strong>
                                <p t-esc="','.join(journal.get('code') or '' for journal in js_data['ks_df_informations']['journals'] if journal.get('selected'))"/>
                            </div>
                            <div t-if="js_data['ks_df_informations'].get('analytic_accounts')" class="col-3">
                                <strong>Analytic:</strong>
                                <p t-esc="', '.join( lt or '' for lt in js_data['ks_df_informations']['selected_analytic_account_names'])"/>
                            </div>
                            <div t-if="js_data['ks_df_informations'].get('analytic_tags')" class="col-3">
                                <strong>Tags:</strong>
                                <p t-esc="', '.join( lt or '' for lt in js_data['ks_df_informations']['selected_analytic_tag_names'])"/>
                            </div>
                        </div>

                        <t t-if="request.env['ir.config_parameter'].sudo().get_param('ks_enable_ledger_in_bal')">
                            <t t-if="js_data['ks_df_informations']['show_hierarchy']">
                                <table class="pims_report_line_table table border mb-0 ks_table_1_pdf pims_report_content">
                                    <thead class="thead-light">
                                        <t t-if="not js_data['ks_df_informations']['ks_report_with_lines']">
                                            <tr style="page-break-inside: avoid;" class="text-center">
                                                <th colspan="5" class="text-left;">Account</th>
                                                <th style="text-align:left;padding-bottom:10px;">Initial Balance</th>
                                                <th style="text-align:left;">Debit</th>
                                                <th style="text-align:left;">Credit</th>
                                                <th style="text-align:left;">Balance</th>
                                            </tr>
                                        </t>
                                        <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                                            <tr style="page-break-inside: avoid;" class="text-center">
                                                <th style="text-align:left;">Date</th>
                                                <th style="text-align:left;">JRNL</th>
                                                <th style="text-align:left;">Partner</th>
                                                <th style="text-align:left;">Move</th>
                                                <th style="text-align:left;">Entry Label</th>
                                                <th style="text-align:right;padding-bottom:10px;">Initial Balance</th>
                                                <th style="text-align:right;padding-bottom:10px;">Debit</th>
                                                <th style="text-align:right;">Credit</th>
                                                <th style="text-align:right;">Balance</th>
                                            </tr>
                                        </t>
                                    </thead>
                                    <t t-if="not js_data['ks_df_informations']['ks_report_with_lines']">
                                        <t t-foreach="js_data['ks_report_lines']" t-as="line">
                                            <tr style="page-break-inside: avoid;" class="pims_report_line_main_tr">
                                                <td colspan="5">
                                                    <span style="color: white;" t-esc="'..'"/>
                                                    <span t-esc="line['name']"/>
                                                </td>
                                                <td class="text-right">
                                                    <t t-if="line['initial_balance']">
                                                        <span t-esc="line['initial_balance']"
                                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span t-att-style="style">-</span>
                                                    </t>
                                                </td>

                                                <td class="text-right">
                                                    <t t-if="line['debit']">
                                                        <span t-esc="line['debit']"
                                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span t-att-style="style">-</span>
                                                    </t>
                                                </td>

                                                <td class="text-right">
                                                    <t t-if="line['credit']">
                                                        <span t-esc="line['credit']"
                                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span t-att-style="style">-</span>
                                                    </t>
                                                </td>
                                                <td class="text-right">
                                                    <t t-if="line['balance']">
                                                        <span t-esc="line['balance']"
                                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span t-att-style="style">-</span>
                                                    </t>
                                                </td>
                                            </tr>

                                        </t>
                                    </t>
                                    <t t-else="">
                                        <t t-call="ks_dynamic_financial_report_customization.general_ledger_hierarchy_pdf_with_initial_balance">
                                            <t t-set="ks_report_lines" t-value="js_data['ks_report_lines']"/>
                                        </t>
                                    </t>

                                </table>

                            </t>
                            <t t-else="">
                                <table class="pims_report_line_table table border mb-0 ks_table_1_pdf pims_report_content">
                                    <thead class="thead-light">
                                        <t t-if="not js_data['ks_df_informations']['ks_report_with_lines']">
                                            <tr style="page-break-inside: avoid;" class="text-center">
                                                <th colspan="5" class="text-left;">Account</th>
                                                <th style="text-align:left;padding-bottom:10px;">Debit</th>
                                                <th style="text-align:left;">Credit</th>
                                                <th style="text-align:left;">Balance</th>
                                            </tr>
                                        </t>
                                        <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                                            <tr style="page-break-inside: avoid;" class="text-center">
                                                <th style="text-align:left;">Date</th>
                                                <th style="text-align:left;">JRNL</th>
                                                <th style="text-align:left;">Partner</th>
                                                <th style="text-align:left;">Move</th>
                                                <th style="text-align:left;">Entry Label</th>
                                                <th style="text-align:right;padding-bottom:10px;">Initial Balance</th>
                                                <th style="text-align:right;padding-bottom:10px;">Debit</th>
                                                <th style="text-align:right;">Credit</th>
                                                <th style="text-align:right;">Balance</th>
                                            </tr>
                                        </t>
                                    </thead>
                                    <t t-foreach="js_data['ks_report_lines']" t-as="line">
                                        <tr style="page-break-inside: avoid;" class="pims_report_line_main_tr">
                                            <td colspan="5">
                                                <span style="color: white;" t-esc="'..'"/>
                                                <span t-esc="js_data['ks_report_lines'][line]['name']"/>
                                            </td>
                                            <td class="text-right">
                                                <t t-if="js_data['ks_report_lines'][line]['initial_balance']">
                                                    <span t-esc="js_data['ks_report_lines'][line]['initial_balance']"
                                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                </t>
                                                <t t-else="">
                                                    <span t-att-style="style">-</span>
                                                </t>
                                            </td>

                                            <td class="text-right">
                                                <t t-if="js_data['ks_report_lines'][line]['debit']">
                                                    <span t-esc="js_data['ks_report_lines'][line]['debit']"
                                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                </t>
                                                <t t-else="">
                                                    <span t-att-style="style">-</span>
                                                </t>
                                            </td>

                                            <td class="text-right">
                                                <t t-if="js_data['ks_report_lines'][line]['credit']">
                                                    <span t-esc="js_data['ks_report_lines'][line]['credit']"
                                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                </t>
                                                <t t-else="">
                                                    <span t-att-style="style">-</span>
                                                </t>
                                            </td>
                                            <td class="text-right">
                                                <t t-if="js_data['ks_report_lines'][line]['balance']">
                                                    <span t-esc="js_data['ks_report_lines'][line]['balance']"
                                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                </t>
                                                <t t-else="">
                                                    <span t-att-style="style">-</span>
                                                </t>
                                            </td>
                                        </tr>

                                        <t t-foreach="js_data['ks_report_lines'][line]['lines']" t-as="sub_line">
                                            <t t-if="sub_line['initial_bal']">
                                                <tr style="page-break-inside: avoid;"
                                                    class="pims_report_line_initial_tr">
                                                    <td colspan="5" class="text-right">
                                                        <span>Initial Balance</span>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="js_data['ks_report_lines'][line]['balance']">
                                                            <span t-esc="sub_line['balance']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="js_data['ks_report_lines'][line]['credit']">
                                                            <span t-esc="sub_line['credit']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="js_data['ks_report_lines'][line]['balance']">
                                                            <span t-esc="sub_line['balance']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                </tr>
                                            </t>
                                            <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                                                <t t-if="not sub_line['initial_bal'] and not sub_line['ending_bal']">
                                                    <tr style="page-break-inside: avoid;"
                                                        class="pims_report_line_data_tr">
                                                        <td>
                                                            <t t-esc="sub_line.get('ldate')"
                                                               t-options='{"widget": "date"}'/>
                                                        </td>
                                                        <td>
                                                            <t t-esc="sub_line.get('lcode')"/>
                                                        </td>
                                                        <td>
                                                            <t t-esc="sub_line.get('partner_name')"/>
                                                        </td>
                                                        <td>
                                                            <t t-esc="sub_line.get('move_name')"/>
                                                        </td>
                                                        <td style="width:30%;">
                                                            <t t-esc="sub_line.get('lname')"/>
                                                        </td>
                                                        <td class="text-right">
                                                            <t t-if="sub_line.get('initial_balance')">
                                                                <span t-esc="sub_line.get('initial_balance')"
                                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                            </t>
                                                            <t t-else="">
                                                                <span t-att-style="style">-</span>
                                                            </t>
                                                        </td>
                                                        <td class="text-right">
                                                            <t t-if="sub_line.get('debit')">
                                                                <span t-esc="sub_line.get('debit')"
                                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                            </t>
                                                            <t t-else="">
                                                                <span t-att-style="style">-</span>
                                                            </t>
                                                        </td>
                                                        <td class="text-right">
                                                            <t t-if="sub_line.get('credit')">
                                                                <span t-esc="sub_line.get('credit')"
                                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                            </t>
                                                            <t t-else="">
                                                                <span t-att-style="style">-</span>
                                                            </t>
                                                        </td>
                                                        <t t-set="initial_balance" t-value="0"></t>
                                                        <t t-if="js_data['ks_report_lines'][line]['initial_balance']">
                                                            <t t-set="initial_balance"
                                                               t-value="js_data['ks_report_lines'][line]['initial_balance']"></t>
                                                        </t>
                                                        <td class="text-right">
                                                            <t t-if="sub_line.get('balance')">
                                                                <span t-esc="sub_line.get('balance') + initial_balance"
                                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                            </t>
                                                            <t t-else="">
                                                                <span t-att-style="style">-</span>
                                                            </t>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </t>
                                            <t t-if="sub_line['ending_bal']">
                                                <tr style="page-break-inside: avoid;"
                                                    class="pims_report_line_initial_tr">
                                                    <td colspan="5" class="text-right">
                                                        <span>Ending Balance</span>
                                                    </td>
                                                    <t t-set="initial_balance" t-value="0"></t>
                                                    <t t-if="js_data['ks_report_lines'][line]['initial_balance']">
                                                        <t t-set="initial_balance"
                                                           t-value="js_data['ks_report_lines'][line]['initial_balance']"></t>
                                                    </t>
                                                    <td class="text-right">
                                                        <t t-if="js_data['ks_report_lines'][line]['initial_balance']">

                                                            <span t-esc="js_data['ks_report_lines'][line]['initial_balance']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="sub_line['debit']">
                                                            <span t-esc="sub_line['debit']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="sub_line['credit']">
                                                            <span t-esc="sub_line['credit']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="sub_line['balance']">
                                                            <span t-esc="sub_line['balance'] + initial_balance"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                    </t>
                                </table>
                            </t>
                        </t>
                        <t t-else="">
                            <t t-if="js_data['ks_df_informations']['show_hierarchy']">
                                <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                                                                        <table class="pims_report_line_table table border mb-0 ks_table_1_pdf pims_report_content">
                                        <thead class="thead-light">
                                            <t t-if="not js_data['ks_df_informations']['ks_report_with_lines']">
                                                <th colspan="5" class="text-left;">Account</th>
                                                <th style="text-align:left;padding-bottom:10px;">Debit</th>
                                                <th style="text-align:left;">Credit</th>
                                                <th style="text-align:left;">Balance</th>
                                            </t>
                                            <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                                                <th colspan="5" class="text-left;">Account</th>
                                                <th style="text-align:left;padding-bottom:10px;">Debit</th>
                                                <th style="text-align:left;">Credit</th>
                                                <th style="text-align:left;">Balance</th>
                                            </t>
                                        </thead>
                                                                                                                <t t-call="ks_dynamic_financial_report_customization.general_ledger_hierarchy_pdf_table">
                                    <t t-set="ks_report_lines" t-value="js_data['ks_report_lines']"/>

                                    </t>

                                    </table>

                                </t>
                                <t t-else="">
                                    <table class="pims_report_line_table table border mb-0 ks_table_1_pdf pims_report_content">
                                        <thead class="thead-light">
                                            <t t-if="not js_data['ks_df_informations']['ks_report_with_lines']">
                                                <th colspan="5" class="text-left;">Account</th>
                                                <th style="text-align:left;padding-bottom:10px;">Debit</th>
                                                <th style="text-align:left;">Credit</th>
                                                <th style="text-align:left;">Balance</th>
                                            </t>
                                            <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                                                <th colspan="5" class="text-left;">Account</th>
                                                <th style="text-align:left;padding-bottom:10px;">Debit</th>
                                                <th style="text-align:left;">Credit</th>
                                                <th style="text-align:left;">Balance</th>
                                            </t>
                                        </thead>
                                        <t t-foreach="js_data['ks_report_lines']" t-as="line">
                                            <tr style="page-break-inside: avoid;" class="pims_report_line_main_tr">
                                                <td colspan="5">
                                                    <span style="color: white;" t-esc="'..'"/>
                                                    <span t-esc="line['name']"/>
                                                </td>
                                                <td class="text-right">
                                                    <t t-if="line['debit']">
                                                        <span t-esc="line['debit']"
                                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span t-att-style="style">-</span>
                                                    </t>
                                                </td>
                                                <td class="text-right">
                                                    <t t-if="line['credit']">
                                                        <span t-esc="line['credit']"
                                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span t-att-style="style">-</span>
                                                    </t>
                                                </td>
                                                <td class="text-right">
                                                    <t t-if="line['balance']">
                                                        <span t-esc="line['balance']"
                                                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                    </t>
                                                    <t t-else="">
                                                        <span t-att-style="style">-</span>
                                                    </t>
                                                </td>
                                            </tr>
                                        </t>
                                    </table>

                                </t>
                            </t>
                            <t t-else="">
                                <table class="pims_report_line_table table border mb-0 ks_table_1_pdf pims_report_content">
                                    <thead class="thead-light">
                                        <t t-if="not js_data['ks_df_informations']['ks_report_with_lines']">
                                            <th colspan="5" class="text-left;">Account</th>
                                            <th style="text-align:left;padding-bottom:10px;">Debit</th>
                                            <th style="text-align:left;">Credit</th>
                                            <th style="text-align:left;">Balance</th>
                                        </t>
                                        <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                                            <th colspan="5" class="text-left;">Account</th>
                                            <th style="text-align:left;padding-bottom:10px;">Debit</th>
                                            <th style="text-align:left;">Credit</th>
                                            <th style="text-align:left;">Balance</th>
                                        </t>
                                    </thead>
                                    <t t-foreach="js_data['ks_report_lines']" t-as="line">
                                        <tr style="page-break-inside: avoid;" class="pims_report_line_main_tr">
                                            <td colspan="5">
                                                <span style="color: white;" t-esc="'..'"/>
                                                <span t-esc="js_data['ks_report_lines'][line]['name']"/>
                                            </td>
                                            <td class="text-right">
                                                <t t-if="js_data['ks_report_lines'][line]['debit']">
                                                    <span t-esc="js_data['ks_report_lines'][line]['debit']"
                                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                </t>
                                                <t t-else="">
                                                    <span t-att-style="style">-</span>
                                                </t>
                                            </td>
                                            <td class="text-right">
                                                <t t-if="js_data['ks_report_lines'][line]['credit']">
                                                    <span t-esc="js_data['ks_report_lines'][line]['credit']"
                                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                </t>
                                                <t t-else="">
                                                    <span t-att-style="style">-</span>
                                                </t>
                                            </td>
                                            <td class="text-right">
                                                <t t-if="js_data['ks_report_lines'][line]['balance']">
                                                    <span t-esc="js_data['ks_report_lines'][line]['balance']"
                                                          t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                </t>
                                                <t t-else="">
                                                    <span t-att-style="style">-</span>
                                                </t>
                                            </td>
                                        </tr>
                                        <t t-foreach="js_data['ks_report_lines'][line]['lines']" t-as="sub_line">
                                            <t t-if="sub_line['initial_bal']">
                                                <tr style="page-break-inside: avoid;" class="pims_report_line_initial_tr">
                                                    <td colspan="5" class="text-right">
                                                        <span>Initial Balance</span>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="js_data['ks_report_lines'][line]['balance']">
                                                            <span t-esc="sub_line['balance']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="js_data['ks_report_lines'][line]['credit']">
                                                            <span t-esc="sub_line['credit']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="js_data['ks_report_lines'][line]['balance']">
                                                            <span t-esc="sub_line['balance']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                </tr>
                                            </t>

                                            <t t-if="js_data['ks_df_informations']['ks_report_with_lines']">
                                                <t t-if="not sub_line['initial_bal'] and not sub_line['ending_bal']">
                                                    <tr style="page-break-inside: avoid;" class="pims_report_line_data_tr">
                                                        <td>
                                                            <t t-esc="sub_line.get('ldate')"
                                                               t-options='{"widget": "date"}'/>
                                                        </td>
                                                        <td>
                                                            <t t-esc="sub_line.get('lcode')"/>
                                                        </td>
                                                        <td>
                                                            <t t-esc="sub_line.get('partner_name')"/>
                                                        </td>
                                                        <td>
                                                            <t t-esc="sub_line.get('move_name')"/>
                                                        </td>
                                                        <td style="width:30%;">
                                                            <t t-esc="sub_line.get('lname')"/>
                                                        </td>
                                                        <td class="text-right">
                                                            <t t-if="sub_line.get('debit')">
                                                                <span t-esc="sub_line.get('debit')"
                                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                            </t>
                                                            <t t-else="">
                                                                <span t-att-style="style">-</span>
                                                            </t>
                                                        </td>
                                                        <td class="text-right">
                                                            <t t-if="sub_line.get('credit')">
                                                                <span t-esc="sub_line.get('credit')"
                                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                            </t>
                                                            <t t-else="">
                                                                <span t-att-style="style">-</span>
                                                            </t>
                                                        </td>
                                                        <td class="text-right">
                                                            <t t-if="sub_line.get('balance')">
                                                                <span t-esc="sub_line.get('balance')"
                                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                            </t>
                                                            <t t-else="">
                                                                <span t-att-style="style">-</span>
                                                            </t>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </t>
                                            <t t-if="sub_line['ending_bal']">
                                                <tr style="page-break-inside: avoid;" class="pims_report_line_initial_tr">
                                                    <td colspan="5" class="text-right">
                                                        <span>Ending Balance</span>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="sub_line['debit']">
                                                            <span t-esc="sub_line['debit']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="sub_line['credit']">
                                                            <span t-esc="sub_line['credit']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                    <td class="text-right">
                                                        <t t-if="sub_line['balance']">
                                                            <span t-esc="sub_line['balance']"
                                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                                        </t>
                                                        <t t-else="">
                                                            <span t-att-style="style">-</span>
                                                        </t>
                                                    </td>
                                                </tr>
                                            </t>
                                        </t>
                                    </t>
                                </table>

                            </t>
                        </t>
                    </div>
                    <p class="my-5" style="text-align:center">*** END OF DOCUMENT ***</p>
                </div>
            </t>
        </t>
    </template>

    <template id="ks_account_report_trial_balance_pdf">

        <t t-foreach="account_data" t-as="account" t-key="account_index">
            <tr class="pims_report_line_tb"> <!-- Normal lines -->
                <td>
                    <span>
                        <t t-esc="account['code']"/>
                        -
                        <t t-esc="account['name']"/>
                    </span>
                </td>
                <td class="text-right" style="width:10%;">
                    <t t-if="account['initial_balance'] and account['initial_balance'] != '-'">
                        <span t-esc="account['initial_balance']"
                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                    </t>
                    <t t-else="">
                        <span t-att-style="style">-</span>
                    </t>
                </td>
                <td class="text-right" style="width:10%;">
                    <t t-if="account['debit'] and account['debit'] != '-'">
                        <span t-esc="account['debit']"
                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                    </t>
                    <t t-else="">
                        <span t-att-style="style">-</span>
                    </t>
                </td>
                <td class="text-right" style="width:10%;">
                    <t t-if="account['credit'] and account['credit'] != '-'">
                        <span t-esc="account['credit']"
                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                    </t>
                    <t t-else="">
                        <span t-att-style="style">-</span>
                    </t>
                </td>
                <td class="text-right" style="width:10%;">
                    <t t-if="account['balance'] and account['balance'] != '-'">
                        <span t-esc="account['balance']"
                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                    </t>
                    <t t-else="">
                        <span t-att-style="style">-</span>
                    </t>
                </td>
                <td class="text-right" style="width:10%;">
                    <t t-if="account['ending_balance'] and account['ending_balance'] != '-'">
                        <span t-esc="account['ending_balance']"
                              t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                    </t>
                    <t t-else="">
                        <span t-att-style="style">-</span>
                    </t>
                </td>
                <td></td>
            </tr>
            <t t-if="'children' in account">
                <t t-set="account_data" t-value="account['children']"/>
                <t t-call="ks_dynamic_financial_report_customization.ks_account_report_trial_balance_pdf"/>
            </t>
        </t>

    </template>


    <template id="ks_dynamic_financial_report.ks_account_report_trial_balance">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <t t-set="company"
                   t-value="request.env['res.company'].sudo().browse(js_data['ks_df_informations'].get('company_id'))"/>
                <div class="page">
                    <div class="oe_structure"/>
                    <div class="container-fluid">
                        <div class="row">
                            <h3 class="py-3 col-12" style="font-size:25px;">
                                <span t-esc="company.name"/>: Trial Balance
                            </h3>
                        </div>

                        <div class="row mb-2 pims_report_content">
                            <div class="col-2">
                                <strong>Display Account</strong>
                                <t t-if="js_data['ks_df_informations'] and js_data['ks_df_informations']['ks_posted_entries']">
                                    <p>Posted Entries</p>
                                </t>
                            </div>
                            <div class="col-2">
                                <strong>Journals:</strong>
                                <p t-esc="', '.join(journal.get('code') or '' for journal in js_data['ks_df_informations']['journals'] if journal.get('selected'))"/>
                            </div>
                            <div class="col-3">
                                <strong>Accounts:</strong>
                                <p t-esc="', '.join(account.get('name') or '' for account in js_data['ks_df_informations']['account'] if account.get('selected'))"/>
                            </div>
                            <t t-if="js_data['ks_df_informations']['date']['ks_process'] == 'range'">
                                <div class="col-2">
                                    <strong>Date From:</strong>
                                    <p t-esc="js_data['ks_df_informations'] and js_data['ks_df_informations']['date']['ks_start_date']"
                                    />
                                </div>
                                <div class="col-2">
                                    <strong>Date To:</strong>
                                    <p t-esc="js_data['ks_df_informations'] and js_data['ks_df_informations']['date']['ks_end_date']"
                                    />
                                </div>
                            </t>
                            <t t-else="">
                                <div class="col-2">
                                    <strong>As of Date:</strong>
                                    <p t-esc="js_data['ks_df_informations'] and js_data['ks_df_informations']['date']['ks_end_date']"
                                    />
                                </div>
                            </t>

                        </div>
                        <div class="row my-2 pims_report_content">
                            <div t-if="js_data['ks_df_informations'].get('analytic_accounts')" class="col-3">
                                <strong>Analytic:</strong>
                                <p t-esc="', '.join( lt or '' for lt in js_data['ks_df_informations']['selected_analytic_account_names'])"/>
                            </div>
                            <div t-if="js_data['ks_df_informations'].get('analytic_tags')" class="col-3">
                                <strong>Tags:</strong>
                                <p t-esc="', '.join( lt or '' for lt in js_data['ks_df_informations']['selected_analytic_tag_names'])"/>
                            </div>
                        </div>
                        <table class="pims_report_line_table pims_report_content border mb-0 ks_table_4_pdf table">
                            <thead class="thead-light w-100">
                                <tr style="page-break-inside: avoid;" class="text-center pims_tb_head">
                                    <th style="width:30%">Account</th>
                                    <th style="text-align:right;padding-bottom:10px;width:25%">Initial Balance</th>
                                    <th style="text-align:right;">Debit</th>
                                    <th style="text-align:right;width:9%">Credit</th>
                                    <th style="text-align:right;width:10%">Balance</th>
                                    <th style="text-align:right;width:26%">Ending Balance</th>
                                    <th> </th>
                                </tr>
                            </thead>
                            <t t-if="not js_data['ks_df_informations']['show_hierarchy']">
                                <t t-foreach="js_data['ks_report_lines']" t-as="line">
                                    <tr class="pims_report_line_tb"> <!-- Normal lines -->
                                        <td>
                                            <span>
                                                <t t-esc="js_data['ks_report_lines'][line]['code']"/>
                                                -
                                                <t t-esc="js_data['ks_report_lines'][line]['name']"/>
                                            </span>
                                        </td>
                                        <td class="text-right" style="width:10%;">
                                            <t t-if="js_data['ks_report_lines'][line]['initial_balance'] and js_data['ks_report_lines'][line]['initial_balance'] != '-'">
                                                <span t-esc="js_data['ks_report_lines'][line]['initial_balance']"
                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                            </t>
                                            <t t-else="">
                                                <span t-att-style="style">-</span>
                                            </t>
                                        </td>
                                        <td class="text-right" style="width:10%;">
                                            <t t-if="js_data['ks_report_lines'][line]['debit'] and js_data['ks_report_lines'][line]['debit'] != '-'">
                                                <span t-esc="js_data['ks_report_lines'][line]['debit']"
                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                            </t>
                                            <t t-else="">
                                                <span t-att-style="style">-</span>
                                            </t>
                                        </td>
                                        <td class="text-right" style="width:10%;">
                                            <t t-if="js_data['ks_report_lines'][line]['credit'] and js_data['ks_report_lines'][line]['credit'] != '-'">
                                                <span t-esc="js_data['ks_report_lines'][line]['credit']"
                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                            </t>
                                            <t t-else="">
                                                <span t-att-style="style">-</span>
                                            </t>
                                        </td>
                                        <td class="text-right" style="width:10%;">
                                            <t t-if="js_data['ks_report_lines'][line]['balance'] and js_data['ks_report_lines'][line]['balance'] != '-'">
                                                <span t-esc="js_data['ks_report_lines'][line]['balance']"
                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                            </t>
                                            <t t-else="">
                                                <span t-att-style="style">-</span>
                                            </t>
                                        </td>
                                        <td class="text-right" style="width:10%;">
                                            <t t-if="js_data['ks_report_lines'][line]['ending_balance'] and js_data['ks_report_lines'][line]['ending_balance'] != '-'">
                                                <span t-esc="js_data['ks_report_lines'][line]['ending_balance']"
                                                      t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                            </t>
                                            <t t-else="">
                                                <span t-att-style="style">-</span>
                                            </t>
                                        </td>
                                        <td></td>
                                    </tr>
                                </t>
                            </t>
                            <t t-else="">
                                <t t-call="ks_dynamic_financial_report_customization.ks_account_report_trial_balance_pdf">
                                    <t t-set="account_data" t-value="js_data['ks_report_lines']"/>
                                </t>
                            </t>

                            <t t-foreach="js_data['ks_subtotal']" t-as="line"> <!-- Subtotal -->
                                <tr style="page-break-inside: avoid;" class="pims_report_line_subtotal">
                                    <td>
                                        <span>
                                            <t t-esc="js_data['ks_subtotal'][line]['code']"/>
                                            <t t-esc="js_data['ks_subtotal'][line]['name']"/>
                                        </span>
                                    </td>
                                    <td class="text-right">
                                        <t t-if="js_data['ks_subtotal'][line]['initial_balance'] and js_data['ks_subtotal'][line]['initial_balance'] != '-'">
                                            <span t-esc="js_data['ks_subtotal'][line]['initial_balance'] "
                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                        </t>
                                        <t t-else="">
                                            <span t-att-style="style">-</span>
                                        </t>
                                    </td>
                                    <td class="text-right">
                                        <t t-if="js_data['ks_subtotal'][line]['debit'] and js_data['ks_subtotal'][line]['debit'] != '-'">
                                            <span t-esc="js_data['ks_subtotal'][line]['debit']"
                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                        </t>
                                        <t t-else="">
                                            <span t-att-style="style">-</span>
                                        </t>
                                    </td>
                                    <td class="text-right">
                                        <t t-if="js_data['ks_subtotal'][line]['credit'] and js_data['ks_subtotal'][line]['credit'] != '-'">
                                            <span t-esc="js_data['ks_subtotal'][line]['credit']"
                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                        </t>
                                        <t t-else="">
                                            <span t-att-style="style">-</span>
                                        </t>
                                    </td>
                                    <td class="text-right">
                                        <t t-if="js_data['ks_subtotal'][line]['balance'] and js_data['ks_subtotal'][line]['balance'] != '-'">
                                            <span t-esc="js_data['ks_subtotal'][line]['balance']"
                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                        </t>
                                        <t t-else="">
                                            <span t-att-style="style">-</span>
                                        </t>
                                    </td>
                                    <td class="text-right">
                                        <t t-if="js_data['ks_subtotal'][line]['ending_balance'] and js_data['ks_subtotal'][line]['ending_balance'] != '-'">
                                            <span t-esc="js_data['ks_subtotal'][line]['ending_balance']"
                                                  t-options="{'widget': 'monetary', 'display_currency': company.currency_id}"/>
                                        </t>
                                        <t t-else="">
                                            <span t-att-style="style">-</span>
                                        </t>
                                    </td>
                                    <td/>
                                </tr>
                            </t>
                        </table>
                    </div>
                    <p class="my-2" style="text-align:center">*** END OF DOCUMENT ***</p>
                </div>
            </t>
        </t>
    </template>

</odoo>